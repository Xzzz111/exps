# CVE Application Form

## Vulnerability Type Info
Unrestricted Upload of File with Dangerous Type

## Vendor of the Product(s) Info
moxi159753

## Affected Product(s)/Code Base Info

**Product**: mogu_blog_v2
**Version**: All current versions (main branch, Nacos branch, Eureka branch)

**Fixed Version**: Not yet fixed

## Has Vendor Confirmed or Acknowledged the Vulnerability?
No

## Attack Type Info
Remote

## Impact Info
- [x] Information Disclosure
- [x] Code Execution (via XSS, potential JSP/JSPX execution)
- [x] Denial of Service
- [ ] Escalation of Privileges
- [x] Other (Content Injection, Phishing, Malware Distribution)

## Affected Component(s)
- `/file/pictures` endpoint
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/restapi/FileRestApi.java`
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/service/impl/FileServiceImpl.java`
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/config/WebSecurityConfig.java`
- `mogu_utils/src/main/java/com/moxi/mogublog/utils/FileUtils.java` (isSafe method)

## Attack Vector(s)
To exploit this vulnerability, an unauthenticated attacker must:
1. Send a multipart/form-data POST request to `/file/pictures` without authentication
2. Set the `source` parameter to `picture` to use parameter-based identity
3. Provide fake `userUid` and `adminUid` values (any non-empty strings)
4. Use known `projectName` (e.g., `blog`) and `sortName` (e.g., `admin`, `user`) values
5. Upload files with dangerous extensions such as HTML, JS, JSP, SQL, or CSS

The application stores uploaded files in publicly accessible static directories with predictable paths. Attackers can directly access these files via HTTP to execute malicious content.

## Suggested Description of the Vulnerability for Use in the CVE
mogu_blog_v2, a microservice-based blog system, contains a critical unauthenticated arbitrary file upload vulnerability in the `/file/pictures` endpoint. The Spring Security configuration permits unauthenticated access to `/file/**` endpoints, and the `uploadPics` controller method does not perform authentication checks. When the `source` parameter is set to `picture`, the application accepts client-provided `userUid`, `adminUid`, `projectName`, and `sortName` values from request parameters without validation. The code only verifies these fields are non-empty (not null) but does not authenticate users or validate UIDs against the database. The `FileUtils.isSafe()` method permits dangerous file types including HTML, JavaScript, CSS, SQL, Java, and Vue files. Attackers can upload malicious HTML files containing JavaScript to conduct stored XSS attacks, phishing pages, malware distribution, and website defacement. Files are stored in predictable, publicly accessible directories and can be executed in victims' browsers. The complete absence of authentication combined with permissive file type validation allows attackers to host arbitrary malicious content on the legitimate domain without any credentials.

## Discoverer(s)/Credits Info
sh7err@vEcho

## Reference(s) Info
https://gitee.com/moxi159753/mogu_blog_v2
https://github.com/moxi624/mogu_blog_v2

## Additional Information
This vulnerability has a CVSS score estimated at 9.8 (Critical). The primary weaknesses are:
- CWE-434: Unrestricted Upload of File with Dangerous Type
- CWE-862: Missing Authorization
- CWE-79: Improper Neutralization of Input During Web Page Generation (XSS)

The vulnerability is extremely dangerous because:
1. No authentication required
2. Allows uploading of executable content (HTML/JS)
3. Files are served from the main domain (cookie access)
4. Predictable storage paths enable easy access
5. Can be used for phishing, XSS, malware distribution, and defacement

The overly permissive file type whitelist (FileUtils.ALL_FILE array) includes document formats (DOC, XLS, PDF), code files (JAVA, JS, VUE, SQL), and web content (HTML, CSS), making this a multi-vector attack surface. The vulnerability is trivial to exploit and poses severe risks to both the application and its users.
