* Vulnerability type info
Server-Side Request Forgery (SSRF)

* Vendor of the product(s) info
orionsec (project owner of Orion-ops)

Affected product(s)/code base info
* Product* Version
Orion-ops <= master commit 5925824997a3109651bbde07460958a7be249ed1 (no fixed version available)

Optional
Has vendor confirmed or acknowledged the vulnerability
No

Attack type info
Remote

Impact info
Information Disclosure, Other (internal network mapping / pivot)

Affected component(s)
MachineInfoController (orion-ops-api/orion-ops-web/src/main/java/cn/orionsec/ops/controller/MachineInfoController.java), MachineInfoServiceImpl (orion-ops-api/orion-ops-service/src/main/java/cn/orionsec/ops/service/impl/MachineInfoServiceImpl.java)

Attack vector(s)
Any authenticated user can invoke /orion/api/machine/direct-test-connect or /orion/api/machine/direct-test-ping with attacker-controlled hostnames and ports; the server attempts to open an SSH session to that destination and returns success vs. timeout, enabling internal port scanning and SSRF.

Suggested description of the vulnerability for use in the CVE info
The Orion-ops machine connectivity test endpoints accept arbitrary destinations from any authenticated account. Because MachineInfoServiceImpl uses those parameters to initiate SSH connections without validation, an attacker can coerce the management server into connecting to internal hosts and learn whether the ports are reachable, effectively providing an SSRF primitive.

Discoverer(s)/Credits info
sh7err@vEcho

Reference(s) info
https://github.com/lijiahangmax/orion-ops

Additional information
Mitigation should restrict the connectivity test APIs to administrators and require the target host to match an existing managed machine record.
