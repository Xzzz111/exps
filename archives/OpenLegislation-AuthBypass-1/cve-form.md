# CVE Submission Form

* **Vulnerability type info**  
Authentication bypass via spoofed trusted-host header

* **Vendor of the product(s) info**  
New York State Senate (OpenLegislation project)

* **Affected product(s)/code base info**  
OpenLegislation REST API

* **Product Version**  
OpenLegislation 3.10.2 (current `dev` branch). No fixed version is available at the time of submission.

* **Has vendor confirmed or acknowledged the vulnerability**  
No

* **Attack type info**  
Remote

* **Impact info**  
Information Disclosure, Other (unauthorized access to admin APIs)

* **Affected component(s)**  
`src/main/java/gov/nysenate/openleg/api/auth/ApiAuthFilter.java`, `src/main/resources/app.properties.example`

* **Attack vector(s)**  
An unauthenticated attacker sends requests directly to `/api/3/**` endpoints while spoofing `X-Forwarded-For: 127.0.0.1` (or any value accepted by `api.auth.ip.whitelist`). The filter blindly trusts the header, interprets the client as whitelisted, and skips the API key check.

* **Suggested description of the vulnerability for use in the CVE info**  
OpenLegislation 3.10.2 and earlier improperly trust any client-supplied `X-Forwarded-For` header when evaluating the `api.auth.ip.whitelist`, allowing remote attackers to bypass API key authentication on every `/api/3/**` endpoint by spoofing a whitelisted address such as `127.0.0.1`.

* **Discoverer(s)/Credits info**  
sh7err@vEcho

* **Reference(s) info**  
https://github.com/nysenate/OpenLegislation/blob/dev/src/main/java/gov/nysenate/openleg/api/auth/ApiAuthFilter.java#L44-L115
https://github.com/nysenate/OpenLegislation/blob/dev/docs/backend/index.md#api-authentication

* **Additional information**  
The issue exists in the default configuration because `api.auth.enable` is `true` and the whitelist regex is `127.0.0.1`. No server-side control validates that `X-Forwarded-For` was injected by a trusted proxy, so any internet client can spoof the header and reach administrative APIs without credentials.
