# CVE Application Form

## Vulnerability Type Info
Path Traversal / Zip Slip

## Vendor of the Product(s) Info
moxi159753

## Affected Product(s)/Code Base Info

**Product**: mogu_blog_v2
**Version**: All current versions (main branch, Nacos branch, Eureka branch)

**Fixed Version**: Not yet fixed

## Has Vendor Confirmed or Acknowledged the Vulnerability?
No

## Attack Type Info
Remote (requires authentication)

## Impact Info
- [ ] Information Disclosure
- [x] Code Execution
- [ ] Denial of Service
- [x] Escalation of Privileges
- [x] Other (Arbitrary File Write)

## Affected Component(s)
- `/networkDisk/unzipFile` endpoint
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/restapi/NetworkDiskRestApi.java`
- `mogu_utils/src/main/java/com/moxi/mogublog/utils/upload/FileOperation.java` (unzip method, lines 209-259)

## Attack Vector(s)
To exploit this vulnerability, an authenticated attacker with network disk access must:
1. Create a malicious ZIP file containing entries with path traversal sequences (e.g., `../../../../tmp/malicious.sh` or `../../../../config/application.yml`)
2. Upload the crafted ZIP file to the network disk through the file upload interface
3. Send a POST request to `/networkDisk/unzipFile` with the uploaded ZIP file's URL
4. The application extracts the ZIP file using `FileOperation.unzip()`, which constructs file paths as `destDirPath + "/" + entry.getName()` without validating that the resolved path stays within the target directory
5. Files with path traversal sequences are written to arbitrary locations on the filesystem

This is a classic Zip Slip vulnerability where ZIP entry names containing `..` sequences can escape the intended extraction directory and write files to any location where the application process has write permissions.

## Suggested Description of the Vulnerability for Use in the CVE
mogu_blog_v2, a microservice-based blog system, contains a Zip Slip path traversal vulnerability in the network disk file decompression functionality. The `/networkDisk/unzipFile` endpoint calls `FileOperation.unzip()` which extracts ZIP archives without validating entry names. At line 241 of `FileOperation.java`, file paths are constructed directly as `new File(destDirPath + "/" + entry.getName())` without checking for path traversal sequences or ensuring the resolved canonical path remains within the target directory. Authenticated attackers with network disk access can upload malicious ZIP files containing entries with names like `../../../../config/application.yml` or `../../../../tmp/malicious.sh`. When the ZIP is extracted, these files are written to arbitrary filesystem locations, escaping the intended extraction directory. This enables attackers to overwrite critical application configuration files, deploy webshells to web-accessible directories, modify executable scripts, or write to system locations, leading to remote code execution and complete system compromise. The vulnerability requires authentication but allows low-privileged users to achieve code execution through arbitrary file write.

## Discoverer(s)/Credits Info
sh7err@vEcho

## Reference(s) Info
https://gitee.com/moxi159753/mogu_blog_v2
https://github.com/moxi624/mogu_blog_v2
https://github.com/snyk/zip-slip-vulnerability
https://security.snyk.io/research/zip-slip-vulnerability

## Additional Information
This vulnerability has a CVSS score estimated at 8.8 (High). The primary weakness is:
- CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')

Zip Slip is a well-known vulnerability class discovered and documented by Snyk in 2018, affecting thousands of projects across multiple programming languages. The vulnerability in mogu_blog_v2 follows the classic Zip Slip pattern:
1. No validation of ZIP entry names
2. Direct concatenation of base path and entry name
3. No canonicalization or boundary checking
4. Unrestricted file creation

While this vulnerability requires authentication (unlike the other discovered vulnerabilities in the same project), it provides a reliable path to code execution for any user with network disk access. Exploitation is straightforward and well-documented, with numerous tools available to create malicious ZIP files.

The impact is severe because:
- Attackers can overwrite any file the application can write to
- Configuration files can be modified to alter system behavior
- Webshells can be deployed for persistent access
- Startup scripts can be modified for code execution on service restart
- The vulnerability is reliable and trivial to exploit with standard ZIP tools

This is a critical vulnerability that should be prioritized for patching.
