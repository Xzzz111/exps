# CVE Application Form

## Vulnerability Type Info
Broken Access Control / Missing Authorization

## Vendor of the Product(s) Info
moxi159753

## Affected Product(s)/Code Base Info

**Product**: mogu_blog_v2
**Version**: All current versions (main branch, Nacos branch, Eureka branch)

**Fixed Version**: Not yet fixed

## Has Vendor Confirmed or Acknowledged the Vulnerability?
No

## Attack Type Info
Remote

## Impact Info
- [ ] Information Disclosure
- [ ] Code Execution
- [x] Denial of Service
- [ ] Escalation of Privileges
- [x] Other (Unauthorized Resource Manipulation)

## Affected Component(s)
- `/storage/initStorageSize` endpoint
- `/storage/editStorageSize` endpoint
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/restapi/StorageRestApi.java`
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/service/impl/StorageServiceImpl.java`
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/config/WebSecurityConfig.java`

## Attack Vector(s)
To exploit this vulnerability, an unauthenticated attacker must:
1. Send a POST request to `/storage/initStorageSize` or `/storage/editStorageSize` without authentication
2. Provide a target administrator's UID in the `adminUid` parameter (can be a known UID like `uid00000000000000000000000000000` or enumerated)
3. Set `maxStorageSize` to an arbitrary value (0 for denial of service, or a large number for unauthorized expansion)

No credentials or special privileges are required. The application directly modifies the database based on the provided `adminUid` without verifying the caller's identity.

## Suggested Description of the Vulnerability for Use in the CVE
mogu_blog_v2, a microservice-based blog system, contains a broken access control vulnerability in the storage management endpoints `/storage/initStorageSize` and `/storage/editStorageSize`. The Spring Security configuration permits unauthenticated access to `/storage/**` endpoints, and the controller methods accept `adminUid` as a client-controlled request parameter without authentication or authorization checks. The service layer directly queries and modifies storage quota records in the database based solely on the provided `adminUid` value. This allows unauthenticated attackers to arbitrarily manipulate storage quotas for any administrator account by setting `maxStorageSize` to zero (causing denial of service) or to excessively large values (enabling unauthorized storage expansion and potential resource exhaustion). The vulnerability completely bypasses storage quota management and can lead to service disruption and business logic abuse.

## Discoverer(s)/Credits Info
sh7err@vEcho

## Reference(s) Info
https://gitee.com/moxi159753/mogu_blog_v2
https://github.com/moxi624/mogu_blog_v2

## Additional Information
This vulnerability has a CVSS score estimated at 7.5 (High). The primary weaknesses are:
- CWE-862: Missing Authorization
- CWE-639: Authorization Bypass Through User-Controlled Key

The vulnerability allows complete control over storage quota allocation without any authentication. In production deployments, this can lead to:
1. Service disruption by setting quotas to zero
2. Resource exhaustion by allocating unlimited storage
3. Business model bypass if storage is monetized
4. Operational chaos through random quota manipulation

The vulnerability is trivial to exploit and requires no special tools or knowledge beyond basic HTTP requests.
