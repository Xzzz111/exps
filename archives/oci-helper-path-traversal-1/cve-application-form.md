# CVE Application Form - oci-helper Path Traversal Vulnerability

---

## Vulnerability Type Info
**Directory/Path Traversal**

---

## Vendor of the Product(s) Info

**Vendor Name**: yohann
**Vendor Homepage**: https://github.com/Yohann0617
**Product Homepage**: https://github.com/Yohann0617/oci-helper

**Note**: This is an open-source project hosted on GitHub. The vendor should be added to the CVE products and sources list if not already present.

---

## Affected Product(s)/Code Base Info

### Product and Version Table

| Product | Version | Status |
|---------|---------|--------|
| oci-helper | V3.2.4 | Affected (Confirmed) |
| oci-helper | V3.2.3 and earlier | Likely Affected (Not Tested) |
| oci-helper | Fixed version | Not Available |

**Software Versions Affected**: Version 3.2.4 and likely all previous versions

**Fixed Version**: None - Vulnerability is currently unpatched as of 2025-11-10

**Product Description**: oci-helper is a Spring Boot-based web application that provides a management panel for Oracle Cloud Infrastructure (OCI). It offers features including instance management, network configuration, IP management, task scheduling, and backup/recovery capabilities.

---

## Vendor Confirmation

**Has vendor confirmed or acknowledged the vulnerability?**: No

**Status**: Vendor notification pending. Vulnerability was discovered through independent security audit and has not yet been reported to the vendor.

---

## Attack Type Info
**Remote**

The vulnerability can be exploited remotely over the network (HTTP/HTTPS) without requiring physical access to the target system.

---

## Impact Info

**☑ Code Execution**
**☑ Information Disclosure**
**☐ Denial of Service**
**☑ Escalation of Privileges**
**☑ Other**

### Detailed Impact Explanation:

1. **Arbitrary File Write**: Attacker can write files to any location on the filesystem where the application has write permissions

2. **Code Execution**: By overwriting critical system files (e.g., cron jobs, shell scripts, SSH authorized_keys), attacker can achieve arbitrary code execution

3. **Information Disclosure**: Attacker can overwrite and subsequently retrieve sensitive files containing confidential information

4. **Escalation of Privileges**: By replacing SSH authorized_keys file, attacker can escalate privileges to root level and gain full system control

5. **Persistent Backdoor**: Attacker can plant malicious cron jobs or startup scripts to maintain persistent access to the compromised system

---

## Affected Component(s)

**Primary Components**:
- `src/main/java/com/yohann/ocihelper/service/impl/OciServiceImpl.java` (Line 146)
- `src/main/java/com/yohann/ocihelper/controller/OciController.java` (addCfg endpoint)
- `src/main/java/com/yohann/ocihelper/bean/params/oci/cfg/AddCfgParams.java` (Parameter binding)

**Affected Functions**:
- `OciServiceImpl.addCfg()` - Main vulnerable function
- `MultipartFile.getOriginalFilename()` - Source of unvalidated user input
- `FileUtil.touch()` - File creation without security validation

**Affected API Endpoint**:
- `POST /api/oci/addCfg` - HTTP endpoint accepting file uploads

---

## Attack Vector(s)

### Exploitation Method:

To exploit this vulnerability, an attacker must:

1. **Obtain Authentication**: Acquire valid credentials and JWT bearer token for the oci-helper application

2. **Craft Malicious Request**: Prepare an HTTP POST request to the `/api/oci/addCfg` endpoint with the following characteristics:
   - Valid authentication token in the Authorization header
   - Multipart/form-data content type
   - File upload with manipulated filename containing path traversal sequences (e.g., `../../../../root/.ssh/authorized_keys`)
   - Required form parameters (username, ociCfgStr)

3. **Submit Request**: Send the crafted request to the target server

4. **Verify Exploitation**: Check that the file was created at the intended malicious location outside the designated directory

### Exploitation Requirements:
- Network access to the oci-helper web application
- Valid user credentials (authentication required)
- Permission to add OCI configurations (standard user privilege)
- Application running with sufficient filesystem permissions to write to target locations

### Example Exploitation:
```bash
# Attacker crafts a request with malicious filename
curl -X POST 'http://target:8818/api/oci/addCfg' \
  -H 'Authorization: Bearer [VALID_TOKEN]' \
  -F 'username=attacker' \
  -F 'ociCfgStr=[DEFAULT]...' \
  -F 'file=@malicious.pem;filename=../../../../root/.ssh/authorized_keys'
```

### Technical Details:
The vulnerability arises because the application directly concatenates user-supplied filename with the base directory path without validation:

```java
String priKeyPath = keyDirPath + File.separator +
                    params.getFile().getOriginalFilename();
File priKey = FileUtil.touch(priKeyPath);
```

No sanitization is performed on `getOriginalFilename()`, allowing path traversal sequences like `../` to escape the intended directory.

---

## Suggested Description of the Vulnerability for Use in the CVE

**Suggested CVE Description**:

A path traversal vulnerability exists in oci-helper version 3.2.4 and earlier in the OCI configuration upload functionality. The application fails to properly validate user-supplied filenames when processing file uploads through the `/api/oci/addCfg` endpoint. An authenticated attacker can exploit this vulnerability by uploading a file with a specially crafted filename containing path traversal sequences (e.g., `../../../`), allowing arbitrary file write to any location on the server filesystem where the application has write permissions. Successful exploitation can lead to complete system compromise through SSH key replacement, configuration tampering, or malicious code injection via cron jobs. The vulnerability is present in the `OciServiceImpl.addCfg()` method at line 146, where `MultipartFile.getOriginalFilename()` is directly concatenated with the base directory path without sanitization. CVSS v3.1 Base Score: 8.1 (High) - AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N.

**Alternative Short Description**:

Path traversal vulnerability in oci-helper v3.2.4 allows authenticated attackers to write arbitrary files outside the intended directory via crafted filename in file upload at `/api/oci/addCfg` endpoint, potentially leading to remote code execution and privilege escalation.

---

## Discoverer(s)/Credits Info

**Individual(s) or Organization(s)**:

**Primary Discoverer**: sh7err@vEcho

**Discovery Method**: Independent security code audit conducted on the oci-helper project

**Contact**: sh7err (GitHub user)

**Organization**: vEcho Security Research Team

---

## Reference(s) Info

**Primary References**:

https://github.com/Yohann0617/oci-helper
https://github.com/Yohann0617/oci-helper/releases/tag/v3.2.4
https://github.com/Yohann0617/oci-helper/blob/master/src/main/java/com/yohann/ocihelper/service/impl/OciServiceImpl.java

**Technical References**:

https://cwe.mitre.org/data/definitions/22.html
https://owasp.org/www-community/attacks/Path_Traversal
https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html

**CVSS Calculator**:

https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N

---

## Additional Information

### Technical Details:

**Vulnerable Code Context**:

The vulnerability exists in the `addCfg()` method of `OciServiceImpl.java` where the application processes OCI private key file uploads. The code directly uses user-controlled input from `MultipartFile.getOriginalFilename()` to construct the file path without any validation:

```java
String priKeyPath = keyDirPath + File.separator +
                    params.getFile().getOriginalFilename();
File priKey = FileUtil.touch(priKeyPath);
```

The Hutool library's `FileUtil.touch()` method creates files and parent directories as needed without performing security checks, enabling the path traversal attack.

### Security Impact Assessment:

**Severity**: HIGH (CVSS 8.1)
- Easy to exploit (requires only valid credentials)
- High impact (system compromise, privilege escalation)
- Remote exploitation without user interaction
- Affects confidentiality and integrity of entire system

### Attack Scenarios:

1. **SSH Key Replacement**: Replace `/root/.ssh/authorized_keys` to gain root SSH access
2. **Configuration Tampering**: Overwrite `application.yml` to modify admin credentials
3. **Cron Job Backdoor**: Create malicious cron job in `/etc/cron.d/`
4. **Startup Script Injection**: Modify system startup scripts for persistence

### Remediation Status:

As of 2025-11-10, this vulnerability remains **unpatched**. The vendor has not yet been notified. Immediate remediation is recommended through:
- Input validation and sanitization of filenames
- Path normalization and verification
- Whitelist-based file extension filtering
- Audit logging of file upload operations

### Testing and Verification:

The vulnerability has been thoroughly tested and confirmed exploitable in version 3.2.4. Proof-of-concept code is available demonstrating arbitrary file write capability.

### Affected Deployment Scenarios:

- Docker deployments (default configuration)
- Standalone Spring Boot deployments
- Cloud-hosted instances (AWS, Azure, GCP)
- On-premise installations

All deployment scenarios are vulnerable regardless of configuration, as the issue exists in application logic.

### Additional Notes:

- Vulnerability requires authentication but no special privileges beyond standard user access
- No client-side restrictions prevent exploitation
- Server-side validation is completely absent
- Framework (Spring Boot) does not provide built-in protection against this specific vulnerability pattern
- Hutool library functions used correctly but without security validation at application level

---

## Submission Details

**Submission Date**: 2025-11-10
**Report Version**: 1.0
**Report Author**: sh7err@vEcho
**CVE Requested For**: oci-helper v3.2.4 Path Traversal Vulnerability

---

## Contact Information for Follow-up

For additional information, clarification, or coordination regarding this vulnerability disclosure, please contact:

**Primary Contact**: sh7err
**Affiliation**: vEcho Security Research
**GitHub**: @sh7err

---

*End of CVE Application Form*
