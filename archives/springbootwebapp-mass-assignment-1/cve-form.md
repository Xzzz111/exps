# CVE Application Form

## Vulnerability Type Info
Mass Assignment / Improper Input Validation (CWE-915)

## Vendor of the Product(s) Info
**Vendor Name**: Spring Framework Guru
**Vendor Website**: https://springframework.guru
**Vendor Contact**: (Tutorial project - open source)

## Affected Product(s)/Code Base Info

### Product Information
| Product | Version |
|---------|---------|
| Spring Boot Web Application (Tutorial Project) | All versions (including latest commit: e4f8728) |

**Repository**: https://github.com/springframeworkguru/spring-boot-web

**Version Status**:
- **Affected Versions**: All existing versions
- **Fixed Version**: No fix available yet

## Vendor Acknowledgement
**Has vendor confirmed or acknowledged the vulnerability?**
☐ Yes
☑ No

**Note**: This is an open-source tutorial project. Vendor has not been notified yet as this is primarily an educational disclosure.

## Attack Type Info
**Attack Type**: Remote

**Network Accessibility**: Yes - Exploitable via HTTP/HTTPS requests

## Impact Info
☑ Information Disclosure
☑ Escalation of Privileges
☐ Code Execution
☑ Denial of Service (Indirect - through data corruption)
☑ Other: Data Integrity Violation, Business Logic Bypass

**Primary Impact**: Data Integrity Violation - attackers can modify arbitrary database records by manipulating HTTP request parameters including system-managed fields (primary keys and version numbers).

## Affected Component(s)
- `src/main/java/guru/springframework/controllers/ProductController.java` (Line 48, `saveProduct()` method)
- `src/main/java/guru/springframework/domain/Product.java` (Entity class with @Id and @Version fields)
- `src/main/resources/templates/productform.html` (Lines 16-17, hidden input fields)

## Attack Vector(s)

### Method of Exploitation

The vulnerability can be exploited through the following methods:

1. **Browser-Based Attack**:
   - User opens the product edit form at `/product/edit/{id}`
   - Attacker uses browser developer tools to modify hidden form fields (`id` and `version`)
   - Upon form submission, a different product is overwritten instead of the intended one

2. **Direct HTTP Request**:
   - Attacker first obtains the target product's version number by viewing its details page (version is exposed in HTML source)
   - Attacker crafts a malicious POST request to `/product` endpoint with manipulated `id` and `version` parameters
   - The application processes the request and overwrites the target product

3. **Automated Exploitation**:
   - Scripts can enumerate products, obtain their version numbers, and systematically modify all products
   - Mass price manipulation attacks (e.g., changing all prices to $0.01)

### Prerequisites for Exploitation
- Network access to the application
- Ability to send HTTP POST requests
- Knowledge of target product ID (can be obtained by browsing the product list)
- Current version number of target product (exposed in HTML source code)

### No Special Conditions Required
- No authentication required (application has no authentication in its current form)
- No user interaction needed (direct HTTP exploitation)
- No elevated privileges required

## Suggested Description of the Vulnerability for Use in the CVE

A Mass Assignment vulnerability exists in Spring Boot Web Application tutorial project maintained by Spring Framework Guru. The vulnerability is present in the ProductController.saveProduct() method which directly binds HTTP request parameters to JPA entity objects without field filtering. Attackers can manipulate system-managed fields including the primary key (@Id) and optimistic locking version number (@Version) by modifying HTTP request parameters. This allows unauthorized modification of arbitrary product records in the database. The vulnerability can be exploited remotely via crafted HTTP POST requests or by modifying hidden form fields in the product edit form. An attacker can obtain the required version number from the HTML source code and use it to bypass optimistic locking protection. Impact includes data integrity violation, business logic bypass (price manipulation), and potential privilege escalation in multi-user scenarios. The vulnerable pattern is commonly found in Spring Boot applications and may be replicated by developers learning from this tutorial, amplifying its impact beyond the original project.

## Discoverer(s)/Credits Info

**Discoverer**: sh7err@vEcho

**Organization**: vEcho Security Research Team

**Discovery Method**: Manual security code audit following OWASP secure coding guidelines and Spring Security best practices

## Reference(s) Info

https://github.com/springframeworkguru/spring-boot-web
https://springframework.guru/spring-boot-web-application-part-1-spring-initializr/
https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html
https://cwe.mitre.org/data/definitions/915.html
https://docs.spring.io/spring-data/jpa/reference/data-commons/is-new-state-detection.html
https://www.baeldung.com/jpa-optimistic-locking

## Additional Information

### Context and Scope

This vulnerability was discovered in a **tutorial project** designed for educational purposes. The Spring Boot Web Application is part of Spring Framework Guru's "Spring Boot - making Spring Fun again!" tutorial series, aimed at teaching Spring Boot fundamentals to beginners.

### Why This Vulnerability Matters Despite Being in a Tutorial

1. **Educational Impact**: This tutorial is widely used by developers learning Spring Boot. The vulnerable code pattern may be replicated in production applications by students who don't understand the security implications.

2. **Pattern Prevalence**: Mass Assignment is a common vulnerability in Spring Boot applications. Similar patterns have been found in numerous production systems.

3. **Teaching Opportunity**: Disclosing this vulnerability provides valuable educational content about:
   - Secure Spring Boot development practices
   - Proper use of DTOs vs. direct entity binding
   - Understanding JPA's isNew() detection mechanism
   - Limitations of optimistic locking for security

4. **Community Benefit**: Helps raise awareness in the Spring Boot developer community about this vulnerability class.

### Technical Details

#### JPA Behavior Analysis

The vulnerability persists despite the presence of `@Version` field because:

- JPA's `isNew()` method checks if version is null (for non-primitive types)
- When version is non-null, JPA performs MERGE instead of PERSIST
- Optimistic locking only prevents concurrent modifications when versions don't match
- Attackers can obtain correct version numbers from HTML source code
- With correct version, merge operation succeeds, overwriting target entity

#### Attack Complexity Assessment

**CVSS v3.1 Preliminary Scoring**:
- **Attack Vector (AV)**: Network (N)
- **Attack Complexity (AC)**: Low (L)
- **Privileges Required (PR)**: None (N)
- **User Interaction (UI)**: None (N)
- **Scope (S)**: Unchanged (U)
- **Confidentiality (C)**: None (N)
- **Integrity (I)**: High (H)
- **Availability (A)**: Low (L)

**Estimated CVSS Score**: 8.2 (High)

### Proof of Concept Summary

A working proof of concept has been developed and validated:
1. Clone repository and start application
2. Access product details to obtain version number from HTML source
3. Submit crafted POST request with modified id and version parameters
4. Verify successful overwrite of target product

Full PoC details are included in the vulnerability report.

### Remediation Guidance

Three remediation approaches have been identified:
1. **DTO Pattern** (Recommended): Use separate DTO classes for user input
2. **@InitBinder Whitelist**: Explicitly allow only safe fields for binding
3. **Path-Based ID**: Get entity ID from URL path, not form data

Detailed implementation examples are provided in the full vulnerability report.

### Responsible Disclosure Notes

- This is an open-source educational project
- The vulnerability will be disclosed publicly to maximize educational value
- A pull request with fixes may be submitted to the repository
- The disclosure aims to educate rather than criticize the tutorial

### Related Work

This vulnerability is related to:
- CVE-2022-22968: Spring Framework data binding vulnerability
- CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes
- OWASP Top 10 2021: A04 - Insecure Design

### Contact Information

For questions or additional information about this vulnerability:
- **Submitter**: sh7err@vEcho
- **Organization**: vEcho Security Research Team

---

**Submission Date**: 2025-01-10
**Vulnerability ID**: Pending CVE assignment
**Status**: Awaiting CVE number assignment
