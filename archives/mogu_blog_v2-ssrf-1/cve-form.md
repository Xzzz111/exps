# CVE Application Form

## Vulnerability Type Info
Server-Side Request Forgery (SSRF)

## Vendor of the Product(s) Info
moxi159753

## Affected Product(s)/Code Base Info

**Product**: mogu_blog_v2
**Version**: All current versions (main branch, Nacos branch, Eureka branch)

**Fixed Version**: Not yet fixed

## Has Vendor Confirmed or Acknowledged the Vulnerability?
No

## Attack Type Info
Remote

## Impact Info
- [x] Information Disclosure
- [x] Code Execution (potential via chain exploitation)
- [ ] Denial of Service
- [ ] Escalation of Privileges
- [ ] Other

## Affected Component(s)
- `/file/uploadPicsByUrl` endpoint
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/restapi/FileRestApi.java`
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/service/impl/FileServiceImpl.java`
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/service/impl/LocalFileServiceImpl.java`
- `mogu_picture/src/main/java/com/moxi/mogublog/picture/config/WebSecurityConfig.java`

## Attack Vector(s)
To exploit this vulnerability, an unauthenticated attacker must:
1. Send a crafted POST request to `/file/uploadPicsByUrl` with a malicious URL in the `urlList` parameter
2. Include fake `userUid`/`adminUid` values (any non-empty string)
3. Inject a `systemConfig` object to control upload behavior
4. Use `file://` protocol URLs to read local files or `http://` URLs targeting internal services for SSRF attacks

No authentication or special privileges are required. The vulnerability can be exploited remotely over the network.

## Suggested Description of the Vulnerability for Use in the CVE
mogu_blog_v2, a microservice-based blog system, contains an unauthenticated Server-Side Request Forgery (SSRF) and arbitrary file read vulnerability in the `/file/uploadPicsByUrl` endpoint. The Spring Security configuration allows public access to `/file/**` endpoints, and the `uploadPictureByUrl` method accepts arbitrary `userUid`/`adminUid` values without database validation. Attackers can inject `systemConfig` parameters and supply malicious URLs (including `file://` URIs) in the `urlList` parameter. The application fetches the content via `URLConnection.getInputStream()` without protocol or host restrictions, saves it to a publicly accessible directory, and returns the URL in the response. This allows unauthenticated attackers to read arbitrary local files (e.g., `/etc/passwd`, configuration files, private keys), access internal network services, and retrieve cloud provider metadata, leading to complete system compromise.

## Discoverer(s)/Credits Info
sh7err@vEcho

## Reference(s) Info
https://gitee.com/moxi159753/mogu_blog_v2
https://github.com/moxi624/mogu_blog_v2

## Additional Information
This is a critical vulnerability with a CVSS score estimated at 9.1+ (Critical). The vulnerability combines multiple weaknesses:
- CWE-918: Server-Side Request Forgery (SSRF)
- CWE-22: Improper Limitation of a Pathname to a Restricted Directory
- CWE-862: Missing Authorization

The vulnerability affects the file service microservice (mogu_picture) and can be exploited without any authentication. It poses severe risks in cloud environments where metadata services can be accessed, potentially leading to full infrastructure compromise.
